<template>
    <div class="container-fluid pt-2">
        <div class="row">

            <div class="col-12 pb-2 border-bottom mb-3 border-clean">
                
                <span class="text-clean"><b>Projeto:</b></span>
                
                
                <button class="btn btn-sm btn-primary p-0 float-end">
                    <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" width="20px" height="20px" version="1.1" style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                    viewBox="0 0 20 20"
                    xmlns:xlink="http://www.w3.org/1999/xlink">
                    <g id="Camada_x0020_1">
                    <path class="fil0" d="M10 5.8c-2.32,0 -4.2,1.88 -4.2,4.2 0,2.32 1.88,4.2 4.2,4.2 2.32,0 4.2,-1.88 4.2,-4.2 0,-2.32 -1.88,-4.2 -4.2,-4.2zm8.37 2.2l-1.35 -0.29c-0.12,-0.36 -0.27,-0.71 -0.44,-1.05l0.75 -1.16c0.13,-0.21 0.1,-0.48 -0.07,-0.66l-2.1 -2.1c-0.18,-0.17 -0.45,-0.2 -0.66,-0.07l-1.16 0.75c-0.34,-0.17 -0.69,-0.32 -1.05,-0.44l-0.29 -1.35c-0.05,-0.24 -0.26,-0.41 -0.51,-0.41l-2.98 0c-0.25,0 -0.46,0.17 -0.51,0.41l-0.29 1.35c-0.36,0.12 -0.71,0.27 -1.05,0.44l-1.16 -0.75c-0.21,-0.13 -0.48,-0.1 -0.66,0.07l-2.1 2.1c-0.17,0.18 -0.2,0.45 -0.07,0.66l0.75 1.16c-0.17,0.34 -0.32,0.69 -0.44,1.05l-1.35 0.29c-0.24,0.05 -0.41,0.26 -0.41,0.51l0 2.98c0,0.25 0.17,0.46 0.41,0.51l1.35 0.29c0.12,0.36 0.27,0.71 0.44,1.05l-0.75 1.16c-0.13,0.21 -0.1,0.48 0.07,0.66l2.1 2.1c0.18,0.17 0.45,0.2 0.66,0.07l1.16 -0.75c0.34,0.17 0.69,0.32 1.05,0.44l0.29 1.35c0.05,0.24 0.26,0.41 0.51,0.41l2.98 0c0.25,0 0.46,-0.17 0.51,-0.41l0.29 -1.35c0.36,-0.12 0.71,-0.27 1.05,-0.44l1.16 0.75c0.21,0.13 0.48,0.1 0.66,-0.07l2.1 -2.1c0.17,-0.18 0.2,-0.45 0.07,-0.66l-0.75 -1.16c0.17,-0.34 0.32,-0.69 0.44,-1.05l1.35 -0.29c0.24,-0.05 0.41,-0.26 0.41,-0.51l0 -2.98c0,-0.25 -0.17,-0.46 -0.41,-0.51l0 0zm-0.64 3.06l-1.24 0.27c-0.19,0.04 -0.34,0.19 -0.39,0.37 -0.14,0.49 -0.33,0.96 -0.58,1.41 -0.1,0.16 -0.09,0.37 0.01,0.54l0.69 1.06 -1.51 1.51 -1.06 -0.69c-0.17,-0.1 -0.38,-0.11 -0.54,-0.01 -0.45,0.25 -0.92,0.44 -1.41,0.58 -0.18,0.05 -0.33,0.2 -0.37,0.39l-0.27 1.24 -2.12 0 -0.27 -1.24c-0.04,-0.19 -0.19,-0.34 -0.37,-0.39 -0.49,-0.14 -0.96,-0.33 -1.41,-0.58 -0.16,-0.1 -0.37,-0.09 -0.54,0.01l-1.06 0.69 -1.51 -1.51 0.69 -1.06c0.1,-0.17 0.11,-0.38 0.01,-0.54 -0.25,-0.45 -0.44,-0.92 -0.58,-1.41 -0.05,-0.18 -0.2,-0.33 -0.39,-0.37l-1.24 -0.27 0 -2.12 1.24 -0.27c0.19,-0.04 0.34,-0.19 0.39,-0.37 0.13,-0.49 0.33,-0.96 0.58,-1.41 0.1,-0.16 0.09,-0.37 -0.01,-0.54l-0.69 -1.06 1.51 -1.51 1.06 0.69c0.17,0.1 0.38,0.11 0.54,0.01 0.45,-0.25 0.92,-0.45 1.41,-0.58 0.18,-0.05 0.33,-0.2 0.37,-0.39l0.27 -1.24 2.12 0 0.27 1.24c0.04,0.19 0.19,0.34 0.37,0.39 0.49,0.13 0.96,0.33 1.41,0.58 0.16,0.1 0.37,0.09 0.54,-0.01l1.06 -0.69 1.51 1.51 -0.69 1.06c-0.1,0.17 -0.11,0.38 -0.01,0.54 0.25,0.45 0.44,0.92 0.58,1.41 0.05,0.18 0.2,0.33 0.39,0.37l1.24 0.27 0 2.12zm-7.73 2.09c-1.74,0 -3.15,-1.41 -3.15,-3.15 0,-1.74 1.41,-3.15 3.15,-3.15 1.74,0 3.15,1.41 3.15,3.15 0,1.74 -1.41,3.15 -3.15,3.15z"/>
                    </g>
                    </svg>
                </button>

                <button class="btn btn-sm p-0 float-end me-2">
                    <img src="img/ic-run-3.svg" >
                </button>
                
                <h4>{{ projectName }}</h4>
                
            </div>

            <!--
            <div class="col-12">
                <div class="form-floating bg-dark">
                    <select class="form-select bg-dark text-white border-0" id="floatingSelectGrid1">
                        <option class="text-white" value="1" selected>Json</option>
                        <option class="text-white" value="2">Text</option>
                    </select>
                    <label for="floatingSelectGrid1">Response:</label>
                </div>
            </div>
            -->
            <div class="col-12 mt-1">

                <span class="text-clean"><b>Arquivo Selecionado:</b></span>
                <button class="btn btn-sm btn-primary p-0 float-end">
                    <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" width="20px" height="20px" version="1.1" style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                    viewBox="0 0 20 20"
                    xmlns:xlink="http://www.w3.org/1999/xlink">
                    <g id="Camada_x0020_1">
                    <path class="fil0" d="M10 5.8c-2.32,0 -4.2,1.88 -4.2,4.2 0,2.32 1.88,4.2 4.2,4.2 2.32,0 4.2,-1.88 4.2,-4.2 0,-2.32 -1.88,-4.2 -4.2,-4.2zm8.37 2.2l-1.35 -0.29c-0.12,-0.36 -0.27,-0.71 -0.44,-1.05l0.75 -1.16c0.13,-0.21 0.1,-0.48 -0.07,-0.66l-2.1 -2.1c-0.18,-0.17 -0.45,-0.2 -0.66,-0.07l-1.16 0.75c-0.34,-0.17 -0.69,-0.32 -1.05,-0.44l-0.29 -1.35c-0.05,-0.24 -0.26,-0.41 -0.51,-0.41l-2.98 0c-0.25,0 -0.46,0.17 -0.51,0.41l-0.29 1.35c-0.36,0.12 -0.71,0.27 -1.05,0.44l-1.16 -0.75c-0.21,-0.13 -0.48,-0.1 -0.66,0.07l-2.1 2.1c-0.17,0.18 -0.2,0.45 -0.07,0.66l0.75 1.16c-0.17,0.34 -0.32,0.69 -0.44,1.05l-1.35 0.29c-0.24,0.05 -0.41,0.26 -0.41,0.51l0 2.98c0,0.25 0.17,0.46 0.41,0.51l1.35 0.29c0.12,0.36 0.27,0.71 0.44,1.05l-0.75 1.16c-0.13,0.21 -0.1,0.48 0.07,0.66l2.1 2.1c0.18,0.17 0.45,0.2 0.66,0.07l1.16 -0.75c0.34,0.17 0.69,0.32 1.05,0.44l0.29 1.35c0.05,0.24 0.26,0.41 0.51,0.41l2.98 0c0.25,0 0.46,-0.17 0.51,-0.41l0.29 -1.35c0.36,-0.12 0.71,-0.27 1.05,-0.44l1.16 0.75c0.21,0.13 0.48,0.1 0.66,-0.07l2.1 -2.1c0.17,-0.18 0.2,-0.45 0.07,-0.66l-0.75 -1.16c0.17,-0.34 0.32,-0.69 0.44,-1.05l1.35 -0.29c0.24,-0.05 0.41,-0.26 0.41,-0.51l0 -2.98c0,-0.25 -0.17,-0.46 -0.41,-0.51l0 0zm-0.64 3.06l-1.24 0.27c-0.19,0.04 -0.34,0.19 -0.39,0.37 -0.14,0.49 -0.33,0.96 -0.58,1.41 -0.1,0.16 -0.09,0.37 0.01,0.54l0.69 1.06 -1.51 1.51 -1.06 -0.69c-0.17,-0.1 -0.38,-0.11 -0.54,-0.01 -0.45,0.25 -0.92,0.44 -1.41,0.58 -0.18,0.05 -0.33,0.2 -0.37,0.39l-0.27 1.24 -2.12 0 -0.27 -1.24c-0.04,-0.19 -0.19,-0.34 -0.37,-0.39 -0.49,-0.14 -0.96,-0.33 -1.41,-0.58 -0.16,-0.1 -0.37,-0.09 -0.54,0.01l-1.06 0.69 -1.51 -1.51 0.69 -1.06c0.1,-0.17 0.11,-0.38 0.01,-0.54 -0.25,-0.45 -0.44,-0.92 -0.58,-1.41 -0.05,-0.18 -0.2,-0.33 -0.39,-0.37l-1.24 -0.27 0 -2.12 1.24 -0.27c0.19,-0.04 0.34,-0.19 0.39,-0.37 0.13,-0.49 0.33,-0.96 0.58,-1.41 0.1,-0.16 0.09,-0.37 -0.01,-0.54l-0.69 -1.06 1.51 -1.51 1.06 0.69c0.17,0.1 0.38,0.11 0.54,0.01 0.45,-0.25 0.92,-0.45 1.41,-0.58 0.18,-0.05 0.33,-0.2 0.37,-0.39l0.27 -1.24 2.12 0 0.27 1.24c0.04,0.19 0.19,0.34 0.37,0.39 0.49,0.13 0.96,0.33 1.41,0.58 0.16,0.1 0.37,0.09 0.54,-0.01l1.06 -0.69 1.51 1.51 -0.69 1.06c-0.1,0.17 -0.11,0.38 -0.01,0.54 0.25,0.45 0.44,0.92 0.58,1.41 0.05,0.18 0.2,0.33 0.39,0.37l1.24 0.27 0 2.12zm-7.73 2.09c-1.74,0 -3.15,-1.41 -3.15,-3.15 0,-1.74 1.41,-3.15 3.15,-3.15 1.74,0 3.15,1.41 3.15,3.15 0,1.74 -1.41,3.15 -3.15,3.15z"/>
                    </g>
                    </svg>
                </button>
                <div class="form-floating bg-dark mt-2">
                    <select @change="onChangeSelect($event)" class="form-select bg-dark text-white border-0" id="floatingSelectGrid2"> 
                        <option v-for="(file, index) in files" :key="index" class="text-white" :value="file">{{ file }}</option>     
                    </select>
                    <label for="floatingSelectGrid2">Config File:</label>
                </div>
            </div>

            <div class="col-12 mt-3">

                <span class="text-clean"><b>Nome:</b></span>
                <p>{{ fileSelected.name }}</p>
                <span class="text-clean"><b>URL Base:</b></span>
                <p>{{ fileSelected.base_url }}</p>
                <span class="text-clean"><b>Headers:</b></span>
                <p><span v-html="readheaders()"></span></p>
            </div>

        </div>
    </div>
</template>

<script>

export default {
    
    props:["projectSlug"],

    created(){
        
        this.useFile("info.json", data => {

            this.files = data.files;
            this.projectName =  data.name;

            this.useFile(this.files[0]+".config.json", data => {
                this.fileSelected = data; 
                this.$emit('changeConfig', this.fileSelected)
            });

        });
    },
    
    data(){
        return {
            projectName:"",
            files: [],
            fileSelected: {
                name:"",
                slug:"",
                base_url:"",
                headers:{}
            }
        }
    },

    methods: {
        
        useFile(file, callback){
            let req = 'projects/'+this.projectSlug+'/'+file;
            fetch(req)
            .then(response => response.json())
            .then((data) => {
                callback(data); 
            })
        },

        readheaders(){
            var template = "";
            if(this.fileSelected.headers){
                template = '<p>';
                Object.keys(this.fileSelected.headers).forEach( item => template += "<b>"+item + ":</b> " +this.fileSelected.headers[item]+"<br>")
                template += "</p>";
            }
            return template
        },

        onChangeSelect(e){
            this.useFile(e.target.value+".config.json", data => {
                this.fileSelected = data;
                this.$emit('changeConfig', this.fileSelected)
            });
        },

    },
}

</script>

<style scoped>
.fil0 {fill:white;fill-rule:nonzero}
</style>